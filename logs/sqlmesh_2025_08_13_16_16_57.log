2025-08-13 16:17:15,972 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-13 16:18:15,379 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-13 16:18:15,415 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-13 16:18:15,420 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__raw (evaluator.py:361)
2025-08-13 16:18:15,421 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__sqlmesh_example (evaluator.py:361)
2025-08-13 16:18:15,481 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ SELECT current_catalog (base.py:2260)
2025-08-13 16:18:15,537 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ SELECT current_catalog (base.py:2260)
2025-08-13 16:18:15,572 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__raw' (evaluator.py:1180)
2025-08-13 16:18:15,632 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__raw" (base.py:2260)
2025-08-13 16:18:15,636 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__sqlmesh_example' (evaluator.py:1180)
2025-08-13 16:18:15,637 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__sqlmesh_example" (base.py:2260)
2025-08-13 16:18:15,714 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'analytics.sqlmesh__raw.raw__events__561768720' (evaluator.py:1542)
2025-08-13 16:18:15,721 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE TABLE IF NOT EXISTS "sqlmesh__raw"."raw__events__561768720" ("event_id" INT, "user_id" INT, "event_type" TEXT, "event_timestamp" TIMESTAMP, "revenue" DECIMAL(10, 2)) (base.py:2260)
2025-08-13 16:18:15,789 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'raw__events__561768720' AND "table_schema" = 'sqlmesh__raw' (base.py:2260)
2025-08-13 16:18:15,804 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DELETE FROM "sqlmesh__raw"."raw__events__561768720" WHERE TRUE (base.py:2260)
2025-08-13 16:18:15,812 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__raw"."raw__events__561768720" ("event_id", "user_id", "event_type", "event_timestamp", "revenue") SELECT CAST("event_id" AS INT) AS "event_id", CAST("user_id" AS INT) AS "user_id", CAST("event_type" AS TEXT) AS "event_type", CAST("event_timestamp" AS TIMESTAMP) AS "event_timestamp", CAST("revenue" AS DECIMAL(10, 2)) AS "revenue" FROM (VALUES "<REDACTED VALUES>") AS "t"("event_id", "user_id", "event_type", "event_timestamp", "revenue") (base.py:2260)
2025-08-13 16:18:15,833 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-13 16:18:16,191 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-10 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."raw"."events": 3950673072> (facade.py:619)
2025-08-13 16:18:16,199 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."raw"."events": 3950673072> (interval.py:213)
2025-08-13 16:18:16,256 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-13 16:18:16,269 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'josh_dev' (facade.py:167)
2025-08-13 16:18:16,338 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-13 16:18:16,357 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh_example__josh_dev' (evaluator.py:1180)
2025-08-13 16:18:16,362 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE SCHEMA IF NOT EXISTS "sqlmesh_example__josh_dev" (base.py:2260)
2025-08-13 16:18:16,368 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.raw__josh_dev' (evaluator.py:1180)
2025-08-13 16:18:16,380 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE SCHEMA IF NOT EXISTS "raw__josh_dev" (base.py:2260)
2025-08-13 16:18:16,504 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.seed_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2185867172' (evaluator.py:1497)
2025-08-13 16:18:16,509 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."seed_model" CASCADE (base.py:2260)
2025-08-13 16:18:16,615 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.raw__josh_dev.events' to point at table 'analytics.sqlmesh__raw.raw__events__561768720' (evaluator.py:1497)
2025-08-13 16:18:16,620 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DROP VIEW IF EXISTS "raw__josh_dev"."events" CASCADE (base.py:2260)
2025-08-13 16:18:16,627 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE VIEW "raw__josh_dev"."events" AS SELECT * FROM "analytics"."sqlmesh__raw"."raw__events__561768720" (base.py:2260)
2025-08-13 16:18:16,635 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE VIEW "sqlmesh_example__josh_dev"."seed_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" (base.py:2260)
2025-08-13 16:18:16,686 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.incremental_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3659766683' (evaluator.py:1497)
2025-08-13 16:18:16,689 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."incremental_model" CASCADE (base.py:2260)
2025-08-13 16:18:16,702 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE VIEW "sqlmesh_example__josh_dev"."incremental_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" (base.py:2260)
2025-08-13 16:18:16,729 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.full_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3968245968' (evaluator.py:1497)
2025-08-13 16:18:16,738 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."full_model" CASCADE (base.py:2260)
2025-08-13 16:18:16,747 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE VIEW "sqlmesh_example__josh_dev"."full_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" (base.py:2260)
2025-08-13 16:18:16,761 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.new_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:1497)
2025-08-13 16:18:16,766 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."new_model" CASCADE (base.py:2260)
2025-08-13 16:18:16,779 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3d61aba6fbf34508b8592075ee24e7ef */ CREATE VIEW "sqlmesh_example__josh_dev"."new_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" (base.py:2260)
2025-08-13 16:18:16,812 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-13 16:18:16,817 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'josh_dev' (environment.py:139)
2025-08-13 16:18:16,835 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
