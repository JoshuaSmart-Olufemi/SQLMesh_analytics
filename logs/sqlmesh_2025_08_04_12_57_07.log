2025-08-04 12:57:31,013 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-04 12:57:31,232 - ThreadPoolExecutor-0_0 - sqlmesh.core.console - WARNING - Model '"test_db"."sqlmesh_example"."full_model"' was not found at /mnt/c/Users/josh/analytics/tests/test_full_model.yaml (console.py:2224)
2025-08-04 12:57:37,468 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0001_init' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0001_init.py'> (migrator.py:177)
2025-08-04 12:57:38,837 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0002_remove_identify' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0002_remove_identify.py'> (migrator.py:177)
2025-08-04 12:57:38,838 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0003_move_batch_size' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0003_move_batch_size.py'> (migrator.py:177)
2025-08-04 12:57:39,080 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0004_environmnent_add_finalized_at' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0004_environmnent_add_finalized_at.py'> (migrator.py:177)
2025-08-04 12:57:39,402 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0005_create_seed_table' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0005_create_seed_table.py'> (migrator.py:177)
2025-08-04 12:57:39,708 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0006_change_seed_hash' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0006_change_seed_hash.py'> (migrator.py:177)
2025-08-04 12:57:39,710 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0007_env_table_info_to_kind' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0007_env_table_info_to_kind.py'> (migrator.py:177)
2025-08-04 12:57:40,165 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0008_create_intervals_table' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0008_create_intervals_table.py'> (migrator.py:177)
2025-08-04 12:57:40,900 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0009_remove_pre_post_hooks' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0009_remove_pre_post_hooks.py'> (migrator.py:177)
2025-08-04 12:57:41,231 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0010_seed_hash_batch_size' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0010_seed_hash_batch_size.py'> (migrator.py:177)
2025-08-04 12:57:41,232 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0011_add_model_kind_name' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0011_add_model_kind_name.py'> (migrator.py:177)
2025-08-04 12:57:41,770 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0012_update_jinja_expressions' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0012_update_jinja_expressions.py'> (migrator.py:177)
2025-08-04 12:57:42,113 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0013_serde_using_model_dialects' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0013_serde_using_model_dialects.py'> (migrator.py:177)
2025-08-04 12:57:42,412 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0014_fix_dev_intervals' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0014_fix_dev_intervals.py'> (migrator.py:177)
2025-08-04 12:57:42,620 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0015_environment_add_promoted_snapshot_ids' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0015_environment_add_promoted_snapshot_ids.py'> (migrator.py:177)
2025-08-04 12:57:42,948 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0016_fix_windows_path' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0016_fix_windows_path.py'> (migrator.py:177)
2025-08-04 12:57:43,188 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0017_fix_windows_seed_path' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0017_fix_windows_seed_path.py'> (migrator.py:177)
2025-08-04 12:57:43,409 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0018_rename_snapshot_model_to_node' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0018_rename_snapshot_model_to_node.py'> (migrator.py:177)
2025-08-04 12:57:43,700 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0019_add_env_suffix_target' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0019_add_env_suffix_target.py'> (migrator.py:177)
2025-08-04 12:57:44,237 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0020_remove_redundant_attributes_from_dbt_models' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0020_remove_redundant_attributes_from_dbt_models.py'> (migrator.py:177)
2025-08-04 12:57:44,491 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0021_fix_table_properties' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0021_fix_table_properties.py'> (migrator.py:177)
2025-08-04 12:57:44,705 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0022_move_project_to_model' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0022_move_project_to_model.py'> (migrator.py:177)
2025-08-04 12:57:45,209 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0023_fix_added_models_with_forward_only_parents' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0023_fix_added_models_with_forward_only_parents.py'> (migrator.py:177)
2025-08-04 12:57:45,533 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0024_replace_model_kind_name_enum_with_value' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0024_replace_model_kind_name_enum_with_value.py'> (migrator.py:177)
2025-08-04 12:57:45,854 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0025_fix_intervals_and_missing_change_category' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0025_fix_intervals_and_missing_change_category.py'> (migrator.py:177)
2025-08-04 12:57:46,182 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0026_remove_dialect_from_seed' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0026_remove_dialect_from_seed.py'> (migrator.py:177)
2025-08-04 12:57:46,498 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0027_minute_interval_to_five' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0027_minute_interval_to_five.py'> (migrator.py:177)
2025-08-04 12:57:46,788 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0028_add_plan_dags_table' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0028_add_plan_dags_table.py'> (migrator.py:177)
2025-08-04 12:57:47,684 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0029_generate_schema_types_using_dialect' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0029_generate_schema_types_using_dialect.py'> (migrator.py:177)
2025-08-04 12:57:48,005 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0030_update_unrestorable_snapshots' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0030_update_unrestorable_snapshots.py'> (migrator.py:177)
2025-08-04 12:57:48,243 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0031_remove_dbt_target_fields' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0031_remove_dbt_target_fields.py'> (migrator.py:177)
2025-08-04 12:57:48,453 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0032_add_sqlmesh_version' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0032_add_sqlmesh_version.py'> (migrator.py:177)
2025-08-04 12:57:47,111 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0033_mysql_fix_blob_text_type' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0033_mysql_fix_blob_text_type.py'> (migrator.py:177)
2025-08-04 12:57:47,112 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0034_add_default_catalog' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0034_add_default_catalog.py'> (migrator.py:177)
2025-08-04 12:57:48,177 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0035_add_catalog_name_override' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0035_add_catalog_name_override.py'> (migrator.py:177)
2025-08-04 12:57:48,495 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0036_delete_plan_dags_bug_fix' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0036_delete_plan_dags_bug_fix.py'> (migrator.py:177)
2025-08-04 12:57:48,819 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0037_remove_dbt_is_incremental_macro' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0037_remove_dbt_is_incremental_macro.py'> (migrator.py:177)
2025-08-04 12:57:49,147 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0038_add_expiration_ts_to_snapshot' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0038_add_expiration_ts_to_snapshot.py'> (migrator.py:177)
2025-08-04 12:57:49,740 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0039_include_environment_in_plan_dag_spec' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0039_include_environment_in_plan_dag_spec.py'> (migrator.py:177)
2025-08-04 12:57:50,002 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0040_add_previous_finalized_snapshots' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0040_add_previous_finalized_snapshots.py'> (migrator.py:177)
2025-08-04 12:57:50,322 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0041_remove_hash_raw_query_attribute' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0041_remove_hash_raw_query_attribute.py'> (migrator.py:177)
2025-08-04 12:57:50,533 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0042_trim_indirect_versions' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0042_trim_indirect_versions.py'> (migrator.py:177)
2025-08-04 12:57:50,893 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0043_fix_remove_obsolete_attributes_in_plan_dags' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0043_fix_remove_obsolete_attributes_in_plan_dags.py'> (migrator.py:177)
2025-08-04 12:57:51,108 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0044_quote_identifiers_in_model_attributes' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0044_quote_identifiers_in_model_attributes.py'> (migrator.py:177)
2025-08-04 12:57:51,110 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0045_move_gateway_variable' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0045_move_gateway_variable.py'> (migrator.py:177)
2025-08-04 12:57:51,412 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0046_add_batch_concurrency' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0046_add_batch_concurrency.py'> (migrator.py:177)
2025-08-04 12:57:51,413 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0047_change_scd_string_to_column' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0047_change_scd_string_to_column.py'> (migrator.py:177)
2025-08-04 12:57:51,414 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0048_drop_indirect_versions' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0048_drop_indirect_versions.py'> (migrator.py:177)
2025-08-04 12:57:51,722 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0049_replace_identifier_with_version_in_seeds_table' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0049_replace_identifier_with_version_in_seeds_table.py'> (migrator.py:177)
2025-08-04 12:57:53,214 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0050_drop_seeds_table' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0050_drop_seeds_table.py'> (migrator.py:177)
2025-08-04 12:57:53,546 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0051_rename_column_descriptions' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0051_rename_column_descriptions.py'> (migrator.py:177)
2025-08-04 12:57:53,887 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0052_add_normalize_name_in_environment_naming_info' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0052_add_normalize_name_in_environment_naming_info.py'> (migrator.py:177)
2025-08-04 12:57:54,470 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0053_custom_model_kind_extra_attributes' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0053_custom_model_kind_extra_attributes.py'> (migrator.py:177)
2025-08-04 12:57:54,470 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0054_fix_trailing_comments' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0054_fix_trailing_comments.py'> (migrator.py:177)
2025-08-04 12:57:54,471 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0055_add_updated_ts_unpaused_ts_ttl_ms_unrestorable_to_snapshot' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0055_add_updated_ts_unpaused_ts_ttl_ms_unrestorable_to_snapshot.py'> (migrator.py:177)
2025-08-04 12:57:56,215 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0056_restore_table_indexes' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0056_restore_table_indexes.py'> (migrator.py:177)
2025-08-04 12:58:00,536 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0057_add_table_format' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0057_add_table_format.py'> (migrator.py:177)
2025-08-04 12:58:00,537 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0058_add_requirements' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0058_add_requirements.py'> (migrator.py:177)
2025-08-04 12:58:00,866 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0059_add_physical_version' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0059_add_physical_version.py'> (migrator.py:177)
2025-08-04 12:58:00,867 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0060_move_audits_to_model' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0060_move_audits_to_model.py'> (migrator.py:177)
2025-08-04 12:58:01,168 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0061_mysql_fix_blob_text_type.py'> (migrator.py:177)
2025-08-04 12:58:01,169 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0062_add_model_gateway.py'> (migrator.py:177)
2025-08-04 12:58:01,170 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0063_change_signals.py'> (migrator.py:177)
2025-08-04 12:58:01,398 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0064_join_when_matched_strings.py'> (migrator.py:177)
2025-08-04 12:58:01,720 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0065_add_model_optimize.py'> (migrator.py:177)
2025-08-04 12:58:01,721 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0066_add_auto_restatements.py'> (migrator.py:177)
2025-08-04 12:58:02,475 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0067_add_tsql_date_full_precision.py'> (migrator.py:177)
2025-08-04 12:58:02,476 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:177)
2025-08-04 12:58:02,477 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0069_update_dev_table_suffix.py'> (migrator.py:177)
2025-08-04 12:58:02,905 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0070_include_grains_in_metadata_hash.py'> (migrator.py:177)
2025-08-04 12:58:02,906 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0071_add_dev_version_to_intervals.py'> (migrator.py:177)
2025-08-04 12:58:03,763 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0072_add_environment_statements.py'> (migrator.py:177)
2025-08-04 12:58:04,084 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0073_remove_symbolic_disable_restatement.py'> (migrator.py:177)
2025-08-04 12:58:04,410 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0074_add_partition_by_time_column_property.py'> (migrator.py:177)
2025-08-04 12:58:04,411 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0075_remove_validate_query.py'> (migrator.py:177)
2025-08-04 12:58:04,737 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0076_add_cron_tz.py'> (migrator.py:177)
2025-08-04 12:58:04,738 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0077_fix_column_type_hash_calculation.py'> (migrator.py:177)
2025-08-04 12:58:04,739 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py'> (migrator.py:177)
2025-08-04 12:58:04,955 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0079_add_gateway_managed_property.py'> (migrator.py:177)
2025-08-04 12:58:05,967 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:177)
2025-08-04 12:58:05,968 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0081_update_partitioned_by.py'> (migrator.py:177)
2025-08-04 12:58:06,348 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:177)
2025-08-04 12:58:06,780 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:177)
2025-08-04 12:58:06,781 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0084_normalize_quote_when_matched_and_merge_filter' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0084_normalize_quote_when_matched_and_merge_filter.py'> (migrator.py:177)
2025-08-04 12:58:06,781 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0085_deterministic_repr' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0085_deterministic_repr.py'> (migrator.py:177)
2025-08-04 12:58:07,214 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0086_check_deterministic_bug' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0086_check_deterministic_bug.py'> (migrator.py:177)
2025-08-04 12:58:07,637 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0087_normalize_blueprint_variables' from '/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/migrations/v0087_normalize_blueprint_variables.py'> (migrator.py:177)
2025-08-04 12:58:08,276 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:196)
2025-08-04 12:58:09,363 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:213)
2025-08-04 12:58:09,788 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:206)
2025-08-04 12:58:59,987 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-04 12:59:01,600 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-04 12:59:01,603 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema test_db.sqlmesh__analytics (evaluator.py:361)
2025-08-04 12:59:03,205 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ SELECT current_catalog (base.py:2260)
2025-08-04 12:59:05,043 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'test_db.sqlmesh__analytics' (evaluator.py:1180)
2025-08-04 12:59:06,443 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__analytics" (base.py:2260)
2025-08-04 12:59:10,203 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'test_db.sqlmesh__analytics.analytics__seed_model__749403793' (evaluator.py:1542)
2025-08-04 12:59:10,206 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ CREATE TABLE IF NOT EXISTS "sqlmesh__analytics"."analytics__seed_model__749403793" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2260)
2025-08-04 12:59:12,365 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'test_db.sqlmesh__analytics.analytics__incremental_model__2271234378' (evaluator.py:1542)
2025-08-04 12:59:12,367 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ CREATE TABLE IF NOT EXISTS "sqlmesh__analytics"."analytics__incremental_model__2271234378" AS SELECT "id" AS "id", "item_id" AS "item_id", "event_date" AS "event_date" FROM "test_db"."sqlmesh_example"."seed_model" AS "seed_model" WHERE "event_date" BETWEEN CAST('1970-01-01' AS DATE) AND CAST('1970-01-01' AS DATE) AND FALSE LIMIT 0 (base.py:2260)
2025-08-04 12:59:13,983 - ThreadPoolExecutor-2_2 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'test_db.sqlmesh__analytics.analytics__full_model__2577587794' (evaluator.py:1542)
2025-08-04 12:59:13,986 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ CREATE TABLE IF NOT EXISTS "sqlmesh__analytics"."analytics__full_model__2577587794" AS SELECT "item_id" AS "item_id", COUNT(DISTINCT "id") AS "num_orders" FROM "test_db"."sqlmesh_example"."incremental_model" AS "incremental_model" WHERE FALSE GROUP BY "item_id" LIMIT 0 (base.py:2260)
2025-08-04 12:59:14,547 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'analytics__seed_model__749403793' AND "table_schema" = 'sqlmesh__analytics' (base.py:2260)
2025-08-04 12:59:14,827 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 1a9ec6545856438c92689130da7afbe9 */ DELETE FROM "sqlmesh__analytics"."analytics__seed_model__749403793" WHERE TRUE (base.py:2260)
2025-08-04 12:59:15,064 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__analytics"."analytics__seed_model__749403793" ("id", "item_id", "event_date") SELECT CAST("id" AS INT) AS "id", CAST("item_id" AS INT) AS "item_id", CAST("event_date" AS DATE) AS "event_date" FROM (VALUES "<REDACTED VALUES>") AS "t"("id", "item_id", "event_date") (base.py:2260)
2025-08-04 12:59:15,560 - MainThread - sqlmesh.core.plan.evaluator - INFO - Execution failed for node SnapshotId<"test_db"."analytics"."full_model": 2894355687> (evaluator.py:196)
Traceback (most recent call last):
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/utils/concurrency.py", line 69, in _process_node
    self.fn(node)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/utils/concurrency.py", line 172, in <lambda>
    lambda s_id: fn(snapshots_by_id[s_id]),
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 425, in <lambda>
    lambda s: self._create_snapshot(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 900, in _create_snapshot
    self._execute_create(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1214, in _execute_create
    evaluation_strategy.create(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1567, in create
    self.adapter.ctas(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/shared.py", line 341, in internal_wrapper
    return func(*list_args, **kwargs)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 570, in ctas
    return self._create_table_from_source_queries(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 790, in _create_table_from_source_queries
    self._create_table(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 828, in _create_table
    self.execute(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 2237, in execute
    self._execute(sql, **kwargs)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 2263, in _execute
    self.cursor.execute(sql, **kwargs)
psycopg2.errors.UndefinedTable: relation "sqlmesh_example.incremental_model" does not exist
LINE 1: ...em_id", COUNT(DISTINCT "id") AS "num_orders" FROM "test_db"....
                                                             ^


The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node SnapshotId<"test_db"."analytics"."full_model": 2894355687>
2025-08-04 12:59:15,778 - MainThread - sqlmesh.core.plan.evaluator - INFO - Execution failed for node SnapshotId<"test_db"."analytics"."incremental_model": 1027562400> (evaluator.py:196)
Traceback (most recent call last):
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/utils/concurrency.py", line 69, in _process_node
    self.fn(node)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/utils/concurrency.py", line 172, in <lambda>
    lambda s_id: fn(snapshots_by_id[s_id]),
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 425, in <lambda>
    lambda s: self._create_snapshot(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 900, in _create_snapshot
    self._execute_create(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1214, in _execute_create
    evaluation_strategy.create(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 1567, in create
    self.adapter.ctas(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/shared.py", line 341, in internal_wrapper
    return func(*list_args, **kwargs)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 570, in ctas
    return self._create_table_from_source_queries(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 790, in _create_table_from_source_queries
    self._create_table(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 828, in _create_table
    self.execute(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 2237, in execute
    self._execute(sql, **kwargs)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/engine_adapter/base.py", line 2263, in _execute
    self.cursor.execute(sql, **kwargs)
psycopg2.errors.UndefinedTable: relation "sqlmesh_example.seed_model" does not exist
LINE 1: ..." AS "item_id", "event_date" AS "event_date" FROM "test_db"....
                                                             ^


The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node SnapshotId<"test_db"."analytics"."incremental_model": 1027562400>
2025-08-04 12:59:15,839 - MainThread - sqlmesh.core.context - INFO - Plan application failed. (context.py:1702)
Traceback (most recent call last):
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/plan/evaluator.py", line 178, in visit_physical_layer_update_stage
    completion_status = self.snapshot_evaluator.create(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 402, in create
    self._create_snapshots(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/snapshot/evaluator.py", line 437, in _create_snapshots
    raise SnapshotCreationFailedError(errors, skipped)
sqlmesh.core.snapshot.evaluator.SnapshotCreationFailedError: Physical table creation failed:

Execution failed for node SnapshotId<"test_db"."analytics"."full_model": 2894355687>
  relation "sqlmesh_example.incremental_model" does not exist
LINE 1: ...em_id", COUNT(DISTINCT "id") AS "num_orders" FROM "test_db"....
                                                             ^


Execution failed for node SnapshotId<"test_db"."analytics"."incremental_model": 1027562400>
  relation "sqlmesh_example.seed_model" does not exist
LINE 1: ..." AS "item_id", "event_date" AS "event_date" FROM "test_db"....
                                                             ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/context.py", line 1694, in apply
    self._apply(plan, circuit_breaker)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/context.py", line 2487, in _apply
    self._scheduler.create_plan_evaluator(self).evaluate(
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/plan/evaluator.py", line 107, in evaluate
    self._evaluate_stages(plan_stages, plan)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/plan/evaluator.py", line 127, in _evaluate_stages
    handler(stage, plan)
  File "/mnt/c/Users/josh/venv/lib/python3.10/site-packages/sqlmesh/core/plan/evaluator.py", line 201, in visit_physical_layer_update_stage
    raise PlanError("Plan application failed.")
sqlmesh.utils.errors.PlanError: Plan application failed.
2025-08-04 12:59:15,853 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
