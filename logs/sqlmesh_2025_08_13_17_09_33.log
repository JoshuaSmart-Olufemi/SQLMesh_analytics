2025-08-13 17:09:45,902 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-13 17:10:10,939 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-13 17:10:10,943 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__analytics (evaluator.py:361)
2025-08-13 17:10:10,944 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__sqlmesh_example (evaluator.py:361)
2025-08-13 17:10:10,944 - ThreadPoolExecutor-1_2 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__staging (evaluator.py:361)
2025-08-13 17:10:10,945 - ThreadPoolExecutor-1_3 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__raw (evaluator.py:361)
2025-08-13 17:10:10,995 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:10:11,044 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:10:11,219 - ThreadPoolExecutor-1_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:10:11,280 - ThreadPoolExecutor-1_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:10:11,326 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-13 17:10:11,328 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-13 17:10:11,331 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-08-13 17:10:11,360 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-08-13 17:10:11,365 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."raw"."events": 3950673072> (snapshot.py:143)
2025-08-13 17:10:11,366 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."analytics"."daily_revenue": 4240679414> (snapshot.py:143)
2025-08-13 17:10:11,367 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."staging"."stg_events": 1492575250> (snapshot.py:143)
2025-08-13 17:10:11,372 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-13 17:10:11,378 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.raw' (evaluator.py:1180)
2025-08-13 17:10:11,441 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE SCHEMA IF NOT EXISTS "raw" (base.py:2260)
2025-08-13 17:10:11,445 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.staging' (evaluator.py:1180)
2025-08-13 17:10:11,446 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE SCHEMA IF NOT EXISTS "staging" (base.py:2260)
2025-08-13 17:10:11,448 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.analytics' (evaluator.py:1180)
2025-08-13 17:10:11,448 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE SCHEMA IF NOT EXISTS "analytics" (base.py:2260)
2025-08-13 17:10:11,514 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.raw.events' to point at table 'analytics.sqlmesh__raw.raw__events__561768720' (evaluator.py:1497)
2025-08-13 17:10:11,516 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ DROP VIEW IF EXISTS "raw"."events" CASCADE (base.py:2260)
2025-08-13 17:10:11,519 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE VIEW "raw"."events" AS SELECT * FROM "analytics"."sqlmesh__raw"."raw__events__561768720" (base.py:2260)
2025-08-13 17:10:11,586 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.staging.stg_events' to point at table 'analytics.sqlmesh__staging.staging__stg_events__2548148315' (evaluator.py:1497)
2025-08-13 17:10:11,587 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ DROP VIEW IF EXISTS "staging"."stg_events" CASCADE (base.py:2260)
2025-08-13 17:10:11,590 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE VIEW "staging"."stg_events" AS SELECT * FROM "analytics"."sqlmesh__staging"."staging__stg_events__2548148315" (base.py:2260)
2025-08-13 17:10:11,596 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ COMMENT ON COLUMN "staging"."stg_events"."event_date" IS 'Extract date for incremental processing' (base.py:2260)
2025-08-13 17:10:11,603 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.analytics.daily_revenue' to point at table 'analytics.sqlmesh__analytics.analytics__daily_revenue__1924015129' (evaluator.py:1497)
2025-08-13 17:10:11,604 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ DROP VIEW IF EXISTS "analytics"."daily_revenue" CASCADE (base.py:2260)
2025-08-13 17:10:11,606 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 71af8983b708425fbd4586da9b12cd90 */ CREATE VIEW "analytics"."daily_revenue" AS SELECT * FROM "analytics"."sqlmesh__analytics"."analytics__daily_revenue__1924015129" (base.py:2260)
2025-08-13 17:10:11,617 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-13 17:10:11,620 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:139)
2025-08-13 17:10:11,626 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
2025-08-13 17:10:14,323 - MainThread - sqlmesh.core.analytics.dispatcher - INFO - Failed to emit events: HTTPSConnectionPool(host='analytics.tobikodata.com', port=443): Read timed out. (read timeout=2) (dispatcher.py:138)
