2025-08-13 16:05:29,591 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 1 intervals for 1 snapshots (interval.py:128)
2025-08-13 16:05:29,591 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (interval.py:213)
2025-08-13 16:05:29,621 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 0 intervals for 0 snapshots (interval.py:128)
2025-08-13 16:05:29,906 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."sqlmesh_example"."incremental_model": 3025917805> (evaluator.py:648)
2025-08-13 16:05:29,968 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-11 00:00:00, 2025-08-13 00:00:00) into analytics.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3659766683' (evaluator.py:703)
2025-08-13 16:05:29,970 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" WHERE "event_date" BETWEEN CAST('2025-08-11' AS DATE) AND CAST('2025-08-12' AS DATE) (base.py:2260)
2025-08-13 16:05:29,978 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-08-12' AS DATE) AND "seed_model"."event_date" >= CAST('2025-08-11' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2025-08-11' AS DATE) AND CAST('2025-08-12' AS DATE) (base.py:2260)
2025-08-13 16:05:29,983 - ThreadPoolExecutor-1_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-11 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."sqlmesh_example"."incremental_model": 3025917805> (facade.py:619)
2025-08-13 16:05:29,984 - ThreadPoolExecutor-1_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."sqlmesh_example"."incremental_model": 3025917805> (interval.py:213)
2025-08-13 16:05:30,063 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 1291504539> (evaluator.py:648)
2025-08-13 16:05:30,129 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-11 00:00:00, 2025-08-13 00:00:00) into analytics.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3968245968' (evaluator.py:703)
2025-08-13 16:05:30,132 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'sqlmesh_example__full_model__3968245968' AND "table_schema" = 'sqlmesh__sqlmesh_example' (base.py:2260)
2025-08-13 16:05:30,141 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" WHERE TRUE (base.py:2260)
2025-08-13 16:05:30,145 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" ("item_id", "num_orders") SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" AS "incremental_model" GROUP BY "incremental_model"."item_id" (base.py:2260)
2025-08-13 16:05:30,149 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 1291504539> (evaluator.py:553)
2025-08-13 16:05:30,153 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'sqlmesh_example__full_model__3968245968') AND "nspname" = 'sqlmesh__sqlmesh_example' (base.py:2260)
2025-08-13 16:05:30,166 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" AS "sqlmesh_example__full_model__3968245968" WHERE "item_id" < 0) AS "audit" (base.py:2260)
2025-08-13 16:05:30,170 - ThreadPoolExecutor-1_1 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-11 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 1291504539> (facade.py:619)
2025-08-13 16:05:30,170 - ThreadPoolExecutor-1_1 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 1291504539> (interval.py:213)
2025-08-13 16:05:30,293 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (evaluator.py:648)
2025-08-13 16:05:30,315 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-11 00:00:00, 2025-08-13 00:00:00) into analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:703)
2025-08-13 16:05:30,319 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'sqlmesh_example__new_model__1686394361' AND "table_schema" = 'sqlmesh__sqlmesh_example' (base.py:2260)
2025-08-13 16:05:30,323 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" WHERE TRUE (base.py:2260)
2025-08-13 16:05:30,328 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" ("item_id", "num_orders", "half") SELECT "full_model"."item_id" AS "item_id", "full_model"."num_orders" AS "num_orders", "full_model"."num_orders" / 2 AS "half" FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" AS "full_model" (base.py:2260)
2025-08-13 16:05:30,336 - ThreadPoolExecutor-1_1 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-11 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (facade.py:619)
2025-08-13 16:05:30,337 - ThreadPoolExecutor-1_1 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (interval.py:213)
2025-08-13 16:05:30,366 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
