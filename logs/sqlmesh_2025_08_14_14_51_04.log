2025-08-14 14:51:23,474 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-14 14:53:05,082 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-14 14:53:05,089 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__analytics (evaluator.py:361)
2025-08-14 14:53:05,090 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__sqlmesh_example (evaluator.py:361)
2025-08-14 14:53:05,090 - ThreadPoolExecutor-1_2 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__staging (evaluator.py:361)
2025-08-14 14:53:05,091 - ThreadPoolExecutor-1_3 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__raw (evaluator.py:361)
2025-08-14 14:53:05,164 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ SELECT
  current_catalog (base.py:2260)
2025-08-14 14:53:05,235 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ SELECT
  current_catalog (base.py:2260)
2025-08-14 14:53:05,307 - ThreadPoolExecutor-1_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ SELECT
  current_catalog (base.py:2260)
2025-08-14 14:53:05,372 - ThreadPoolExecutor-1_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ SELECT
  current_catalog (base.py:2260)
2025-08-14 14:53:05,432 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-14 14:53:05,434 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-14 14:53:05,437 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-08-14 14:53:05,474 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-08-14 14:53:05,480 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Pausing snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 1291504539> (snapshot.py:172)
2025-08-14 14:53:05,481 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Pausing snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (snapshot.py:172)
2025-08-14 14:53:05,482 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."sqlmesh_example"."full_model": 2070410384> (snapshot.py:143)
2025-08-14 14:53:05,482 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 1754313528> (snapshot.py:143)
2025-08-14 14:53:05,483 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."analytics"."daily_revenue": 3418150025> (snapshot.py:143)
2025-08-14 14:53:05,484 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"analytics"."staging"."stg_events": 2456517470> (snapshot.py:143)
2025-08-14 14:53:05,493 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-14 14:53:05,500 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh_example' (evaluator.py:1180)
2025-08-14 14:53:05,599 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh_example" (base.py:2260)
2025-08-14 14:53:05,606 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.analytics' (evaluator.py:1180)
2025-08-14 14:53:05,619 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE SCHEMA IF NOT EXISTS "analytics" (base.py:2260)
2025-08-14 14:53:05,627 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.staging' (evaluator.py:1180)
2025-08-14 14:53:05,631 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE SCHEMA IF NOT EXISTS "staging" (base.py:2260)
2025-08-14 14:53:05,701 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.staging.stg_events' to point at table 'analytics.sqlmesh__staging.staging__stg_events__1053797422' (evaluator.py:1497)
2025-08-14 14:53:05,703 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ DROP VIEW IF EXISTS "staging"."stg_events" CASCADE (base.py:2260)
2025-08-14 14:53:05,758 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example.full_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3968245968' (evaluator.py:1497)
2025-08-14 14:53:05,760 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ DROP VIEW IF EXISTS "sqlmesh_example"."full_model" CASCADE (base.py:2260)
2025-08-14 14:53:05,762 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE VIEW "staging"."stg_events" AS
SELECT
  *
FROM "analytics"."sqlmesh__staging"."staging__stg_events__1053797422" (base.py:2260)
2025-08-14 14:53:05,765 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE VIEW "sqlmesh_example"."full_model" AS
SELECT
  *
FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" (base.py:2260)
2025-08-14 14:53:05,770 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ COMMENT ON COLUMN "staging"."stg_events"."event_date" IS 'Extract date for incremental processing' (base.py:2260)
2025-08-14 14:53:05,836 - ThreadPoolExecutor-2_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.analytics.daily_revenue' to point at table 'analytics.sqlmesh__analytics.analytics__daily_revenue__276492176' (evaluator.py:1497)
2025-08-14 14:53:05,836 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example.new_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:1497)
2025-08-14 14:53:05,838 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ DROP VIEW IF EXISTS "analytics"."daily_revenue" CASCADE (base.py:2260)
2025-08-14 14:53:05,840 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ DROP VIEW IF EXISTS "sqlmesh_example"."new_model" CASCADE (base.py:2260)
2025-08-14 14:53:05,842 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE VIEW "sqlmesh_example"."new_model" AS
SELECT
  *
FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" (base.py:2260)
2025-08-14 14:53:05,843 - ThreadPoolExecutor-2_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ CREATE VIEW "analytics"."daily_revenue" AS
SELECT
  *
FROM "analytics"."sqlmesh__analytics"."analytics__daily_revenue__276492176" (base.py:2260)
2025-08-14 14:53:05,845 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 475ba32b38924eba9f92cff17c755f83 */ COMMENT ON VIEW "sqlmesh_example"."new_model" IS 'demo/example model' (base.py:2260)
2025-08-14 14:53:05,856 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-14 14:53:05,860 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:139)
2025-08-14 14:53:05,868 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
