2025-08-13 12:21:40,058 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-13 12:31:23,439 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-13 12:31:23,495 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-13 12:31:23,500 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__sqlmesh_example (evaluator.py:361)
2025-08-13 12:31:23,696 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ SELECT current_catalog (base.py:2260)
2025-08-13 12:31:23,734 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__sqlmesh_example' (evaluator.py:1180)
2025-08-13 12:31:23,806 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__sqlmesh_example" (base.py:2260)
2025-08-13 12:31:23,906 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:1542)
2025-08-13 12:31:23,908 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE TABLE IF NOT EXISTS "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" ("item_id" INT, "num_orders" BIGINT, "half" BIGINT) (base.py:2260)
2025-08-13 12:31:23,924 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ COMMENT ON TABLE "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" IS 'demo/example model' (base.py:2260)
2025-08-13 12:31:23,932 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.new_model' (evaluator.py:1564)
2025-08-13 12:31:23,934 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ SELECT "full_model"."item_id" AS "item_id", "full_model"."num_orders" AS "num_orders", "full_model"."num_orders" / 2 AS "half" FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" AS "full_model" WHERE FALSE LIMIT 0 (base.py:2260)
2025-08-13 12:31:23,948 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-13 12:31:23,954 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (evaluator.py:648)
2025-08-13 12:31:24,042 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-10 00:00:00, 2025-08-11 00:00:00) into analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:703)
2025-08-13 12:31:24,046 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'sqlmesh_example__new_model__1686394361' AND "table_schema" = 'sqlmesh__sqlmesh_example' (base.py:2260)
2025-08-13 12:31:24,062 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ DELETE FROM "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" WHERE TRUE (base.py:2260)
2025-08-13 12:31:24,066 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ INSERT INTO "sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" ("item_id", "num_orders", "half") SELECT "full_model"."item_id" AS "item_id", "full_model"."num_orders" AS "num_orders", "full_model"."num_orders" / 2 AS "half" FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" AS "full_model" (base.py:2260)
2025-08-13 12:31:24,297 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-10 00:00:00, 2025-08-11 00:00:00) for snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (facade.py:619)
2025-08-13 12:31:24,298 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."sqlmesh_example"."new_model": 3098620597> (interval.py:213)
2025-08-13 12:31:24,321 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-13 12:31:24,327 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'josh_dev' (facade.py:167)
2025-08-13 12:31:24,358 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-13 12:31:24,365 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh_example__josh_dev' (evaluator.py:1180)
2025-08-13 12:31:24,366 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE SCHEMA IF NOT EXISTS "sqlmesh_example__josh_dev" (base.py:2260)
2025-08-13 12:31:24,447 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.seed_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2185867172' (evaluator.py:1497)
2025-08-13 12:31:24,449 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."seed_model" CASCADE (base.py:2260)
2025-08-13 12:31:24,467 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE VIEW "sqlmesh_example__josh_dev"."seed_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" (base.py:2260)
2025-08-13 12:31:24,563 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.incremental_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3659766683' (evaluator.py:1497)
2025-08-13 12:31:24,566 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."incremental_model" CASCADE (base.py:2260)
2025-08-13 12:31:24,573 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE VIEW "sqlmesh_example__josh_dev"."incremental_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" (base.py:2260)
2025-08-13 12:31:24,588 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.full_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3968245968' (evaluator.py:1497)
2025-08-13 12:31:24,591 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."full_model" CASCADE (base.py:2260)
2025-08-13 12:31:24,595 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE VIEW "sqlmesh_example__josh_dev"."full_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" (base.py:2260)
2025-08-13 12:31:24,603 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.new_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:1497)
2025-08-13 12:31:24,606 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."new_model" CASCADE (base.py:2260)
2025-08-13 12:31:24,609 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 0c6fd1d15a064c85899d0f917df0cf7c */ CREATE VIEW "sqlmesh_example__josh_dev"."new_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" (base.py:2260)
2025-08-13 12:31:24,619 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-13 12:31:24,627 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'josh_dev' (environment.py:139)
2025-08-13 12:31:24,635 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
