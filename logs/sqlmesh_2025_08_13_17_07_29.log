2025-08-13 17:07:50,024 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:483)
2025-08-13 17:08:41,537 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-08-13 17:08:41,581 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-08-13 17:08:41,584 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__analytics (evaluator.py:361)
2025-08-13 17:08:41,585 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__staging (evaluator.py:361)
2025-08-13 17:08:41,585 - ThreadPoolExecutor-1_2 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__sqlmesh_example (evaluator.py:361)
2025-08-13 17:08:41,586 - ThreadPoolExecutor-1_3 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema analytics.sqlmesh__raw (evaluator.py:361)
2025-08-13 17:08:41,623 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:08:41,662 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:08:41,702 - ThreadPoolExecutor-1_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:08:41,741 - ThreadPoolExecutor-1_3 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT current_catalog (base.py:2260)
2025-08-13 17:08:41,798 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__raw' (evaluator.py:1180)
2025-08-13 17:08:41,844 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__raw" (base.py:2260)
2025-08-13 17:08:41,846 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__sqlmesh_example' (evaluator.py:1180)
2025-08-13 17:08:41,847 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__sqlmesh_example" (base.py:2260)
2025-08-13 17:08:41,848 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__analytics' (evaluator.py:1180)
2025-08-13 17:08:41,848 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__analytics" (base.py:2260)
2025-08-13 17:08:41,851 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh__staging' (evaluator.py:1180)
2025-08-13 17:08:41,852 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh__staging" (base.py:2260)
2025-08-13 17:08:41,890 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'staging__stg_events__2548148315' AND "table_schema" = 'sqlmesh__staging' (base.py:2260)
2025-08-13 17:08:41,896 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating view 'analytics.sqlmesh__staging.staging__stg_events__2548148315' (evaluator.py:1983)
2025-08-13 17:08:41,905 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "sqlmesh__staging"."staging__stg_events__2548148315" AS SELECT "events"."event_id" AS "event_id", "events"."user_id" AS "user_id", "events"."event_type" AS "event_type", "events"."event_timestamp" AS "event_timestamp", DATE("events"."event_timestamp") AS "event_date", "events"."revenue" AS "revenue" FROM "analytics"."sqlmesh__raw"."raw__events__561768720" AS "events" WHERE NOT "events"."event_id" IS NULL (base.py:2260)
2025-08-13 17:08:41,915 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ COMMENT ON COLUMN "sqlmesh__staging"."staging__stg_events__2548148315"."event_date" IS 'Extract date for incremental processing' (base.py:2260)
2025-08-13 17:08:41,978 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'analytics.sqlmesh__analytics.analytics__daily_revenue__1924015129' (evaluator.py:1542)
2025-08-13 17:08:41,979 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE TABLE IF NOT EXISTS "sqlmesh__analytics"."analytics__daily_revenue__1924015129" ("event_date" DATE, "unique_users" BIGINT, "total_revenue" DECIMAL(10, 2)) (base.py:2260)
2025-08-13 17:08:41,986 - ThreadPoolExecutor-2_1 - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'analytics.daily_revenue' (evaluator.py:1564)
2025-08-13 17:08:41,987 - ThreadPoolExecutor-2_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT "stg_events"."event_date" AS "event_date", COUNT(DISTINCT "stg_events"."user_id") AS "unique_users", COALESCE(SUM(CASE WHEN "stg_events"."event_type" = 'purchase' THEN "stg_events"."revenue" END), 0) AS "total_revenue" FROM "analytics"."sqlmesh__staging"."staging__stg_events__2548148315" AS "stg_events" WHERE FALSE AND FALSE GROUP BY "stg_events"."event_date" LIMIT 0 (base.py:2260)
2025-08-13 17:08:42,000 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-08-13 17:08:42,005 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."staging"."stg_events": 1492575250> (evaluator.py:648)
2025-08-13 17:08:42,054 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-08-10 00:00:00, 2025-08-13 00:00:00) into analytics.sqlmesh__staging.staging__stg_events__2548148315' (evaluator.py:703)
2025-08-13 17:08:42,056 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'staging__stg_events__2548148315' AND "table_schema" = 'sqlmesh__staging' (base.py:2260)
2025-08-13 17:08:42,062 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Skipping creation of the view 'analytics.sqlmesh__staging.staging__stg_events__2548148315' (evaluator.py:1934)
2025-08-13 17:08:42,229 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-08-10 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."staging"."stg_events": 1492575250> (facade.py:619)
2025-08-13 17:08:42,230 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."staging"."stg_events": 1492575250> (interval.py:213)
2025-08-13 17:08:42,242 - ThreadPoolExecutor-3_1 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"analytics"."analytics"."daily_revenue": 4240679414> (evaluator.py:648)
2025-08-13 17:08:42,301 - ThreadPoolExecutor-3_1 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2024-01-01 00:00:00, 2025-08-13 00:00:00) into analytics.sqlmesh__analytics.analytics__daily_revenue__1924015129' (evaluator.py:703)
2025-08-13 17:08:42,303 - ThreadPoolExecutor-3_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DELETE FROM "sqlmesh__analytics"."analytics__daily_revenue__1924015129" WHERE "event_date" BETWEEN CAST('2024-01-01' AS DATE) AND CAST('2025-08-12' AS DATE) (base.py:2260)
2025-08-13 17:08:42,320 - ThreadPoolExecutor-3_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ INSERT INTO "sqlmesh__analytics"."analytics__daily_revenue__1924015129" ("event_date", "unique_users", "total_revenue") SELECT "event_date", "unique_users", "total_revenue" FROM (SELECT "stg_events"."event_date" AS "event_date", COUNT(DISTINCT "stg_events"."user_id") AS "unique_users", COALESCE(SUM(CASE WHEN "stg_events"."event_type" = 'purchase' THEN "stg_events"."revenue" END), 0) AS "total_revenue" FROM "analytics"."sqlmesh__staging"."staging__stg_events__2548148315" AS "stg_events" WHERE "stg_events"."event_date" < '2025-08-12' AND "stg_events"."event_date" >= '2024-01-01' GROUP BY "stg_events"."event_date") AS "_subquery" WHERE "event_date" BETWEEN CAST('2024-01-01' AS DATE) AND CAST('2025-08-12' AS DATE) (base.py:2260)
2025-08-13 17:08:42,466 - ThreadPoolExecutor-3_1 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2024-01-01 00:00:00, 2025-08-13 00:00:00) for snapshot SnapshotId<"analytics"."analytics"."daily_revenue": 4240679414> (facade.py:619)
2025-08-13 17:08:42,467 - ThreadPoolExecutor-3_1 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"analytics"."analytics"."daily_revenue": 4240679414> (interval.py:213)
2025-08-13 17:08:42,480 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-08-13 17:08:42,483 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'josh_dev' (facade.py:167)
2025-08-13 17:08:42,540 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-08-13 17:08:42,544 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.staging__josh_dev' (evaluator.py:1180)
2025-08-13 17:08:42,545 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "staging__josh_dev" (base.py:2260)
2025-08-13 17:08:42,547 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.sqlmesh_example__josh_dev' (evaluator.py:1180)
2025-08-13 17:08:42,547 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "sqlmesh_example__josh_dev" (base.py:2260)
2025-08-13 17:08:42,549 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.analytics__josh_dev' (evaluator.py:1180)
2025-08-13 17:08:42,549 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "analytics__josh_dev" (base.py:2260)
2025-08-13 17:08:42,550 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'analytics.raw__josh_dev' (evaluator.py:1180)
2025-08-13 17:08:42,551 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE SCHEMA IF NOT EXISTS "raw__josh_dev" (base.py:2260)
2025-08-13 17:08:42,610 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.raw__josh_dev.events' to point at table 'analytics.sqlmesh__raw.raw__events__561768720' (evaluator.py:1497)
2025-08-13 17:08:42,612 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "raw__josh_dev"."events" CASCADE (base.py:2260)
2025-08-13 17:08:42,659 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.seed_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2185867172' (evaluator.py:1497)
2025-08-13 17:08:42,661 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."seed_model" CASCADE (base.py:2260)
2025-08-13 17:08:42,663 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "raw__josh_dev"."events" AS SELECT * FROM "analytics"."sqlmesh__raw"."raw__events__561768720" (base.py:2260)
2025-08-13 17:08:42,664 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "sqlmesh_example__josh_dev"."seed_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2185867172" (base.py:2260)
2025-08-13 17:08:42,720 - ThreadPoolExecutor-4_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.staging__josh_dev.stg_events' to point at table 'analytics.sqlmesh__staging.staging__stg_events__2548148315' (evaluator.py:1497)
2025-08-13 17:08:42,720 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.incremental_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3659766683' (evaluator.py:1497)
2025-08-13 17:08:42,722 - ThreadPoolExecutor-4_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "staging__josh_dev"."stg_events" CASCADE (base.py:2260)
2025-08-13 17:08:42,722 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."incremental_model" CASCADE (base.py:2260)
2025-08-13 17:08:42,724 - ThreadPoolExecutor-4_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "staging__josh_dev"."stg_events" AS SELECT * FROM "analytics"."sqlmesh__staging"."staging__stg_events__2548148315" (base.py:2260)
2025-08-13 17:08:42,725 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "sqlmesh_example__josh_dev"."incremental_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3659766683" (base.py:2260)
2025-08-13 17:08:42,728 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.full_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__3968245968' (evaluator.py:1497)
2025-08-13 17:08:42,728 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."full_model" CASCADE (base.py:2260)
2025-08-13 17:08:42,730 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "sqlmesh_example__josh_dev"."full_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__3968245968" (base.py:2260)
2025-08-13 17:08:42,732 - ThreadPoolExecutor-4_2 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.analytics__josh_dev.daily_revenue' to point at table 'analytics.sqlmesh__analytics.analytics__daily_revenue__1924015129' (evaluator.py:1497)
2025-08-13 17:08:42,733 - ThreadPoolExecutor-4_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "analytics__josh_dev"."daily_revenue" CASCADE (base.py:2260)
2025-08-13 17:08:42,735 - ThreadPoolExecutor-4_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "analytics__josh_dev"."daily_revenue" AS SELECT * FROM "analytics"."sqlmesh__analytics"."analytics__daily_revenue__1924015129" (base.py:2260)
2025-08-13 17:08:42,736 - ThreadPoolExecutor-4_1 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'analytics.sqlmesh_example__josh_dev.new_model' to point at table 'analytics.sqlmesh__sqlmesh_example.sqlmesh_example__new_model__1686394361' (evaluator.py:1497)
2025-08-13 17:08:42,737 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ DROP VIEW IF EXISTS "sqlmesh_example__josh_dev"."new_model" CASCADE (base.py:2260)
2025-08-13 17:08:42,740 - ThreadPoolExecutor-4_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: ea7abba4e1824f04b953568c45db1fe7 */ CREATE VIEW "sqlmesh_example__josh_dev"."new_model" AS SELECT * FROM "analytics"."sqlmesh__sqlmesh_example"."sqlmesh_example__new_model__1686394361" (base.py:2260)
2025-08-13 17:08:42,748 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-08-13 17:08:42,751 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'josh_dev' (environment.py:139)
2025-08-13 17:08:42,756 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
2025-08-13 17:08:45,435 - MainThread - sqlmesh.core.analytics.dispatcher - INFO - Failed to emit events: HTTPSConnectionPool(host='analytics.tobikodata.com', port=443): Read timed out. (read timeout=2) (dispatcher.py:138)
